<!DOCTYPE html5>
<html>
	<body>

	<input type="file" id="files" name="files[]" multiple />
	<div id="content"></div>

	<script>
		let myFile;
		
		function handleFileSelect(evt) {
			var files = evt.target.files; // FileList object

			for (var i = 0, f; f = files[i]; i++) {

				var reader = new FileReader();

				// Closure to capture the file information.
				reader.onload = (function(theFile) {
					return function(e) {
					  myFile = reader.result;
					  processData(myFile);
					};
				})(f);

			  reader.readAsText(f);
			}
		}


		function processData(data) {	
			let csv_lines = data.split("\n");
			let objectNames =  csv_lines[0].split(",");
			let entries = [];
			for(let i = 1; i < csv_lines.length; i++){
				entry = csv_lines[i].split(",");
				entries[i-1] = new Object();
				for(let j = 0; j < entry.length; j++){
					entries[i-1][objectNames[j]] = entry[j];	
				}			
				entries.push(entries[i-1]);
			}
			document.getElementById('content').innerHTML = JSON.stringify(entries);
		}

		document.getElementById('files').addEventListener('change', handleFileSelect, false);
	  
	</script>

	</body>
</html> 
